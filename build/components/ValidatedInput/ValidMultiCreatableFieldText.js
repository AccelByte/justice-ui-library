import{jsxs as e,jsx as t,Fragment as i}from"react/jsx-runtime";import*as a from"react";import{s}from"../../style-inject.es-1f59c1d0.js";import{c as l}from"../../index-6ea95111.js";import{InlinePopover as r}from"../InlinePopover/index.js";import{b as o,c as n,a as c,F as d}from"../../index-204d6af5.js";import{getCommonValidationErrorMessage as p}from"../../utils/inputValidation.js";import{C as u}from"../../CreatableSelect-a1c4e86a.js";import{trimExcessiveSpace as m}from"../../utils/typography.js";import"../../index-23fbd8ab.js";import"../../objectWithoutPropertiesLoose-1e1a7051.js";import"../../index-3f17275b.js";import"../../index-dd80248b.js";import"styled-components";import"../../math-bf9ecd01.js";import"../../context-f854a00e.js";import"../../elevation-6b1ae944.js";import"../../Popper-914da2a0.js";import"../../memoize-one.esm-8827f1ac.js";import"../../setPrototypeOf-c6ba02e6.js";import"../../inheritsLoose-6fd5c6e3.js";import"../../types/enum.js";import"../../index.es-62933797.js";import"../../server-d796a789.js";import"stream";import"../../utils/i18n/index.js";import"../../inherits-d3723d19.js";import"../../nonIterableRest-e93b6547.js";import"../../unsupportedIterableToArray-0ca076cc.js";import"../../utils/i18n/loadLanguages.js";import"../../fa_icons-aa14317c.js";import"../../purify.es-49746c08.js";import"../Spinner/index.js";import"../Button/index.js";import"../../objectWithoutProperties-ff712cd0.js";import"../../get-ae46b391.js";import"../../objectSpread-31108fba.js";import"../../constants/common.js";import"../Select/index.js";import"../../createSelect-617ff574.js";import"../../index-72b69d08.js";import"../../core.esm-ab7112b3.js";import"../../Select-4a98500c.js";import"../../use-memo-one.esm-19c0a4a5.js";s('@import url("https://fonts.googleapis.com/css?family=Roboto:400,500&display=swap");.valid-multi-creatable-field-text .react-select__multi-value{background-color:#004ec3!important;color:#fff}.valid-multi-creatable-field-text .react-select__multi-value__label,.valid-multi-creatable-field-text .react-select__multi-value__remove{color:#fff!important}.valid-multi-creatable-field-text .react-select__multi-value__remove:hover{background-color:transparent!important}.valid-multi-creatable-field-text .fieldHeader{align-items:baseline;display:flex;justify-content:space-between}.valid-multi-creatable-field-text .fieldHeader span{align-items:flex-end;color:#687792;display:flex;font-size:14px}.valid-multi-creatable-field-text .react-select__control{background-color:#fff;border-color:#b8bfcd;border-width:1px;cursor:text}.valid-multi-creatable-field-text .react-select__control .react-select__indicator span{cursor:pointer}.valid-multi-creatable-field-text .valid-multi-creatable-field-text-input-container{min-height:40px;position:relative}.valid-multi-creatable-field-text .valid-multi-creatable-field-text-input-container:not(.focusedFieldText) label+div>div>div>div>div>div:hover{border:1px solid #687792}.valid-multi-creatable-field-text .valid-multi-creatable-field-text-input-container.focusedFieldText .react-select__control{border:2px solid #0b6cff}');class h{constructor(){this.validationMap=new Map,this.subscriber=new Set}set(e,t){this.validationMap.set(e,t),this.notifySubscribers()}get(e){return this.validationMap.get(e)||null}clear(){this.validationMap=new Map,this.notifySubscribers()}listen(e){this.subscriber.add(e)}unlisten(e){this.subscriber.delete(e)}clearSubscriber(){this.subscriber=new Set}isAllValid(){if(0===this.validationMap.size)return!0;return Array.from(this.validationMap.values()).every((e=>null===e))}notifySubscribers(){Array.from(this.subscriber).forEach((e=>e()))}}const f=2147483647,b=["Tab","Enter",","],v={DropdownIndicator:null};class x extends a.Component{validation;constructor(e){super(e),this.state={inputValue:"",isFocus:!1},this.validation=new h,this.validation.listen((()=>this.setState({})))}createOption=e=>{const t=(e=>{const t=m(e);return{label:t,value:t}})(e);if(!this.props.value.find((e=>e.value===t.value))){const e=[...this.props.value,t];this.handleChange(e)}};handleBlur=e=>{const t=e.currentTarget.value;t&&!this.validation.get("inputValue")&&this.createOption(t);const{onBlur:i}=this.props;this.setState({isFocus:!1}),i&&i()};handleFocus=()=>{this.setState({isFocus:!0})};handleChange=e=>{const{onChange:t}=this.props;t&&t(e)};handleInputChange=e=>{const{validateInput:t}=this.props;this.setState({inputValue:e}),t&&t(this.validation,e)};handleKeyDown=e=>{const{inputValue:t}=this.state,{inputMaxLength:i,maxItem:a,value:s,separatorKeys:l=b}=this.props,r=l.includes(e.key);if(r&&e.preventDefault(),a&&s.length>=a)return void e.preventDefault();!t||i&&t.length>i||this.validation.get("inputValue")||r&&(this.createOption(this.state.inputValue),this.setState({inputValue:""}))};render(){const{label:a,counterLabel:s,placeholder:m,errMessage:h,helperText:b,isRequired:x=!0,value:j,isDisabled:g,tooltip:y,backspaceRemovesValue:_=!0,inputMin:S,inputMax:M=f,inputMaxLength:V,maxItem:C,popoverContent:w,popoverPlacement:F,dataQa:I,formatOptionLabel:L}=this.props,{inputValue:k}=this.state,D=this.validation.get("inputValue");return e("div",{className:"valid-multi-creatable-field-text",children:[e("div",{className:"fieldHeader",children:[!!a&&t(o,{label:a,isRequired:x,tooltip:y}),t("span",{children:!!C&&e(i,{children:[t(n,{value:j.map((e=>e.value.charAt(0))).join(""),maxLength:C,className:"pr-1"}),!(!a&&!s)&&t("span",{children:s||a})]})})]}),t("div",{className:l("valid-multi-creatable-field-text-input-container",{focusedFieldText:this.state.isFocus}),children:t(r,{content:w,isOpen:this.state.isFocus,placement:F,children:t("div",{"data-qa-id":I&&I,children:t(u,{className:"styled-atlaskit-select",isDisabled:g,classNamePrefix:"styled-atlaskit-select",inputValue:k,components:v,isClearable:!0,isMulti:!0,backspaceRemovesValue:_,menuIsOpen:!1,placeholder:m,onInputChange:this.handleInputChange,onChange:this.handleChange,onKeyDown:this.handleKeyDown,value:j,onBlur:this.handleBlur,onFocus:this.handleFocus,formatOptionLabel:L})})})}),(h||k.length>0&&D)&&t(c,{message:h||p(D,{fieldName:a||"",min:S,max:M,maxLength:V})}),b&&t(d,{message:b})]})}}export{x as ValidMultiCreatableFieldText};
